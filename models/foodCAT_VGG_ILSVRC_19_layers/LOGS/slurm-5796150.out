I0429 16:53:12.834329 14219 caffe.cpp:185] Using GPUs 0
I0429 16:53:17.569370 14219 solver.cpp:48] Initializing solver from parameters: 
test_iter: 915
test_interval: 1000
base_lr: 0.001
display: 20
max_iter: 600000
lr_policy: "step"
gamma: 0.1
momentum: 0.9
weight_decay: 0.0005
stepsize: 20000
snapshot: 10000
snapshot_prefix: "models/foodCAT_VGG_ILSVRC_19_layers/snapshots/ss_foodCAT_VGG_ILSVRC_19_layers_train"
solver_mode: GPU
device_id: 0
net: "models/foodCAT_VGG_ILSVRC_19_layers/CLUSTER/VGG_ILSVRC_19_layers_train_val.prototxt"
I0429 16:53:17.571120 14219 solver.cpp:91] Creating training net from net file: models/foodCAT_VGG_ILSVRC_19_layers/CLUSTER/VGG_ILSVRC_19_layers_train_val.prototxt
I0429 16:53:17.674845 14219 net.cpp:322] The NetState phase (0) differed from the phase (1) specified by a rule in layer data
I0429 16:53:17.674934 14219 net.cpp:322] The NetState phase (0) differed from the phase (1) specified by a rule in layer accuracy/top1
I0429 16:53:17.674957 14219 net.cpp:322] The NetState phase (0) differed from the phase (1) specified by a rule in layer accuracy/top5
I0429 16:53:17.675186 14219 net.cpp:49] Initializing net from parameters: 
name: "foodCAT_VGG_ILSVRC_19_layer"
state {
  phase: TRAIN
}
layer {
  name: "data"
  type: "ImageData"
  top: "data"
  top: "label"
  include {
    phase: TRAIN
  }
  transform_param {
    mirror: true
    crop_size: 224
    mean_value: 104
    mean_value: 117
    mean_value: 123
  }
  image_data_param {
    source: "foodCAT_CLUSTER/train.txt"
    batch_size: 16
    shuffle: true
    new_height: 256
    new_width: 256
  }
}
layer {
  name: "conv1_1"
  type: "Convolution"
  bottom: "data"
  top: "conv1_1"
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU1_1"
  type: "ReLU"
  bottom: "conv1_1"
  top: "conv1_1"
}
layer {
  name: "conv1_2"
  type: "Convolution"
  bottom: "conv1_1"
  top: "conv1_2"
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU1_2"
  type: "ReLU"
  bottom: "conv1_2"
  top: "conv1_2"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1_2"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2_1"
  type: "Convolution"
  bottom: "pool1"
  top: "conv2_1"
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU2_1"
  type: "ReLU"
  bottom: "conv2_1"
  top: "conv2_1"
}
layer {
  name: "conv2_2"
  type: "Convolution"
  bottom: "conv2_1"
  top: "conv2_2"
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU2_2"
  type: "ReLU"
  bottom: "conv2_2"
  top: "conv2_2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2_2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv3_1"
  type: "Convolution"
  bottom: "pool2"
  top: "conv3_1"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU3_1"
  type: "ReLU"
  bottom: "conv3_1"
  top: "conv3_1"
}
layer {
  name: "conv3_2"
  type: "Convolution"
  bottom: "conv3_1"
  top: "conv3_2"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU3_2"
  type: "ReLU"
  bottom: "conv3_2"
  top: "conv3_2"
}
layer {
  name: "conv3_3"
  type: "Convolution"
  bottom: "conv3_2"
  top: "conv3_3"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU3_3"
  type: "ReLU"
  bottom: "conv3_3"
  top: "conv3_3"
}
layer {
  name: "conv3_4"
  type: "Convolution"
  bottom: "conv3_3"
  top: "conv3_4"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU3_4"
  type: "ReLU"
  bottom: "conv3_4"
  top: "conv3_4"
}
layer {
  name: "pool3"
  type: "Pooling"
  bottom: "conv3_4"
  top: "pool3"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv4_1"
  type: "Convolution"
  bottom: "pool3"
  top: "conv4_1"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU4_1"
  type: "ReLU"
  bottom: "conv4_1"
  top: "conv4_1"
}
layer {
  name: "conv4_2"
  type: "Convolution"
  bottom: "conv4_1"
  top: "conv4_2"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU4_2"
  type: "ReLU"
  bottom: "conv4_2"
  top: "conv4_2"
}
layer {
  name: "conv4_3"
  type: "Convolution"
  bottom: "conv4_2"
  top: "conv4_3"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU4_3"
  type: "ReLU"
  bottom: "conv4_3"
  top: "conv4_3"
}
layer {
  name: "conv4_4"
  type: "Convolution"
  bottom: "conv4_3"
  top: "conv4_4"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU4_4"
  type: "ReLU"
  bottom: "conv4_4"
  top: "conv4_4"
}
layer {
  name: "pool4"
  type: "Pooling"
  bottom: "conv4_4"
  top: "pool4"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv5_1"
  type: "Convolution"
  bottom: "pool4"
  top: "conv5_1"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU5_1"
  type: "ReLU"
  bottom: "conv5_1"
  top: "conv5_1"
}
layer {
  name: "conv5_2"
  type: "Convolution"
  bottom: "conv5_1"
  top: "conv5_2"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU5_2"
  type: "ReLU"
  bottom: "conv5_2"
  top: "conv5_2"
}
layer {
  name: "conv5_3"
  type: "Convolution"
  bottom: "conv5_2"
  top: "conv5_3"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU5_3"
  type: "ReLU"
  bottom: "conv5_3"
  top: "conv5_3"
}
layer {
  name: "conv5_4"
  type: "Convolution"
  bottom: "conv5_3"
  top: "conv5_4"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU5_4"
  type: "ReLU"
  bottom: "conv5_4"
  top: "conv5_4"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5_4"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "ReLU6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "ReLU7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8_foodCAT"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8_foodCAT"
  inner_product_param {
    num_output: 218
  }
}
layer {
  name: "loss"
  type: "SoftmaxWithLoss"
  bottom: "fc8_foodCAT"
  bottom: "label"
  top: "loss/loss"
}
I0429 16:53:17.675391 14219 layer_factory.hpp:77] Creating layer data
I0429 16:53:17.675462 14219 net.cpp:106] Creating Layer data
I0429 16:53:17.675488 14219 net.cpp:411] data -> data
I0429 16:53:17.675534 14219 net.cpp:411] data -> label
I0429 16:53:17.676036 14219 image_data_layer.cpp:38] Opening file foodCAT_CLUSTER/train.txt
I0429 16:53:17.741590 14219 image_data_layer.cpp:48] Shuffling data
I0429 16:53:17.749526 14219 image_data_layer.cpp:53] A total of 117113 images.
I0429 16:53:18.256686 14219 image_data_layer.cpp:80] output data size: 16,3,224,224
I0429 16:53:18.273524 14219 net.cpp:150] Setting up data
I0429 16:53:18.273613 14219 net.cpp:157] Top shape: 16 3 224 224 (2408448)
I0429 16:53:18.273638 14219 net.cpp:157] Top shape: 16 (16)
I0429 16:53:18.273656 14219 net.cpp:165] Memory required for data: 9633856
I0429 16:53:18.273676 14219 layer_factory.hpp:77] Creating layer conv1_1
I0429 16:53:18.273711 14219 net.cpp:106] Creating Layer conv1_1
I0429 16:53:18.273733 14219 net.cpp:454] conv1_1 <- data
I0429 16:53:18.273772 14219 net.cpp:411] conv1_1 -> conv1_1
I0429 16:53:19.688287 14219 net.cpp:150] Setting up conv1_1
I0429 16:53:19.689128 14219 net.cpp:157] Top shape: 16 64 224 224 (51380224)
I0429 16:53:19.689177 14219 net.cpp:165] Memory required for data: 215154752
I0429 16:53:19.689213 14219 layer_factory.hpp:77] Creating layer ReLU1_1
I0429 16:53:19.689244 14219 net.cpp:106] Creating Layer ReLU1_1
I0429 16:53:19.689265 14219 net.cpp:454] ReLU1_1 <- conv1_1
I0429 16:53:19.689283 14219 net.cpp:397] ReLU1_1 -> conv1_1 (in-place)
I0429 16:53:19.689455 14219 net.cpp:150] Setting up ReLU1_1
I0429 16:53:19.689486 14219 net.cpp:157] Top shape: 16 64 224 224 (51380224)
I0429 16:53:19.689503 14219 net.cpp:165] Memory required for data: 420675648
I0429 16:53:19.689519 14219 layer_factory.hpp:77] Creating layer conv1_2
I0429 16:53:19.689541 14219 net.cpp:106] Creating Layer conv1_2
I0429 16:53:19.689559 14219 net.cpp:454] conv1_2 <- conv1_1
I0429 16:53:19.689577 14219 net.cpp:411] conv1_2 -> conv1_2
I0429 16:53:19.690439 14219 net.cpp:150] Setting up conv1_2
I0429 16:53:19.690479 14219 net.cpp:157] Top shape: 16 64 224 224 (51380224)
I0429 16:53:19.690498 14219 net.cpp:165] Memory required for data: 626196544
I0429 16:53:19.690522 14219 layer_factory.hpp:77] Creating layer ReLU1_2
I0429 16:53:19.690544 14219 net.cpp:106] Creating Layer ReLU1_2
I0429 16:53:19.690562 14219 net.cpp:454] ReLU1_2 <- conv1_2
I0429 16:53:19.690580 14219 net.cpp:397] ReLU1_2 -> conv1_2 (in-place)
I0429 16:53:19.690861 14219 net.cpp:150] Setting up ReLU1_2
I0429 16:53:19.690898 14219 net.cpp:157] Top shape: 16 64 224 224 (51380224)
I0429 16:53:19.690917 14219 net.cpp:165] Memory required for data: 831717440
I0429 16:53:19.690933 14219 layer_factory.hpp:77] Creating layer pool1
I0429 16:53:19.690955 14219 net.cpp:106] Creating Layer pool1
I0429 16:53:19.690974 14219 net.cpp:454] pool1 <- conv1_2
I0429 16:53:19.690992 14219 net.cpp:411] pool1 -> pool1
I0429 16:53:19.691072 14219 net.cpp:150] Setting up pool1
I0429 16:53:19.691098 14219 net.cpp:157] Top shape: 16 64 112 112 (12845056)
I0429 16:53:19.691114 14219 net.cpp:165] Memory required for data: 883097664
I0429 16:53:19.691130 14219 layer_factory.hpp:77] Creating layer conv2_1
I0429 16:53:19.691153 14219 net.cpp:106] Creating Layer conv2_1
I0429 16:53:19.691170 14219 net.cpp:454] conv2_1 <- pool1
I0429 16:53:19.691189 14219 net.cpp:411] conv2_1 -> conv2_1
I0429 16:53:19.693259 14219 net.cpp:150] Setting up conv2_1
I0429 16:53:19.693300 14219 net.cpp:157] Top shape: 16 128 112 112 (25690112)
I0429 16:53:19.693320 14219 net.cpp:165] Memory required for data: 985858112
I0429 16:53:19.693341 14219 layer_factory.hpp:77] Creating layer ReLU2_1
I0429 16:53:19.693362 14219 net.cpp:106] Creating Layer ReLU2_1
I0429 16:53:19.693380 14219 net.cpp:454] ReLU2_1 <- conv2_1
I0429 16:53:19.693400 14219 net.cpp:397] ReLU2_1 -> conv2_1 (in-place)
I0429 16:53:19.693583 14219 net.cpp:150] Setting up ReLU2_1
I0429 16:53:19.693611 14219 net.cpp:157] Top shape: 16 128 112 112 (25690112)
I0429 16:53:19.693629 14219 net.cpp:165] Memory required for data: 1088618560
I0429 16:53:19.693645 14219 layer_factory.hpp:77] Creating layer conv2_2
I0429 16:53:19.693666 14219 net.cpp:106] Creating Layer conv2_2
I0429 16:53:19.693686 14219 net.cpp:454] conv2_2 <- conv2_1
I0429 16:53:19.693706 14219 net.cpp:411] conv2_2 -> conv2_2
I0429 16:53:19.694699 14219 net.cpp:150] Setting up conv2_2
I0429 16:53:19.694736 14219 net.cpp:157] Top shape: 16 128 112 112 (25690112)
I0429 16:53:19.694756 14219 net.cpp:165] Memory required for data: 1191379008
I0429 16:53:19.694774 14219 layer_factory.hpp:77] Creating layer ReLU2_2
I0429 16:53:19.694797 14219 net.cpp:106] Creating Layer ReLU2_2
I0429 16:53:19.694814 14219 net.cpp:454] ReLU2_2 <- conv2_2
I0429 16:53:19.694833 14219 net.cpp:397] ReLU2_2 -> conv2_2 (in-place)
I0429 16:53:19.695013 14219 net.cpp:150] Setting up ReLU2_2
I0429 16:53:19.695042 14219 net.cpp:157] Top shape: 16 128 112 112 (25690112)
I0429 16:53:19.695060 14219 net.cpp:165] Memory required for data: 1294139456
I0429 16:53:19.695075 14219 layer_factory.hpp:77] Creating layer pool2
I0429 16:53:19.695093 14219 net.cpp:106] Creating Layer pool2
I0429 16:53:19.695122 14219 net.cpp:454] pool2 <- conv2_2
I0429 16:53:19.695154 14219 net.cpp:411] pool2 -> pool2
I0429 16:53:19.695212 14219 net.cpp:150] Setting up pool2
I0429 16:53:19.695236 14219 net.cpp:157] Top shape: 16 128 56 56 (6422528)
I0429 16:53:19.695252 14219 net.cpp:165] Memory required for data: 1319829568
I0429 16:53:19.695267 14219 layer_factory.hpp:77] Creating layer conv3_1
I0429 16:53:19.695289 14219 net.cpp:106] Creating Layer conv3_1
I0429 16:53:19.695307 14219 net.cpp:454] conv3_1 <- pool2
I0429 16:53:19.695327 14219 net.cpp:411] conv3_1 -> conv3_1
I0429 16:53:19.697489 14219 net.cpp:150] Setting up conv3_1
I0429 16:53:19.697552 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:19.697571 14219 net.cpp:165] Memory required for data: 1371209792
I0429 16:53:19.697592 14219 layer_factory.hpp:77] Creating layer ReLU3_1
I0429 16:53:19.697612 14219 net.cpp:106] Creating Layer ReLU3_1
I0429 16:53:19.697628 14219 net.cpp:454] ReLU3_1 <- conv3_1
I0429 16:53:19.697645 14219 net.cpp:397] ReLU3_1 -> conv3_1 (in-place)
I0429 16:53:19.697919 14219 net.cpp:150] Setting up ReLU3_1
I0429 16:53:19.697952 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:19.697968 14219 net.cpp:165] Memory required for data: 1422590016
I0429 16:53:19.697983 14219 layer_factory.hpp:77] Creating layer conv3_2
I0429 16:53:19.698004 14219 net.cpp:106] Creating Layer conv3_2
I0429 16:53:19.698022 14219 net.cpp:454] conv3_2 <- conv3_1
I0429 16:53:19.698040 14219 net.cpp:411] conv3_2 -> conv3_2
I0429 16:53:19.700273 14219 net.cpp:150] Setting up conv3_2
I0429 16:53:19.700310 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:19.700327 14219 net.cpp:165] Memory required for data: 1473970240
I0429 16:53:19.700345 14219 layer_factory.hpp:77] Creating layer ReLU3_2
I0429 16:53:19.700366 14219 net.cpp:106] Creating Layer ReLU3_2
I0429 16:53:19.700382 14219 net.cpp:454] ReLU3_2 <- conv3_2
I0429 16:53:19.700399 14219 net.cpp:397] ReLU3_2 -> conv3_2 (in-place)
I0429 16:53:19.700563 14219 net.cpp:150] Setting up ReLU3_2
I0429 16:53:19.700590 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:19.700606 14219 net.cpp:165] Memory required for data: 1525350464
I0429 16:53:19.700620 14219 layer_factory.hpp:77] Creating layer conv3_3
I0429 16:53:19.700641 14219 net.cpp:106] Creating Layer conv3_3
I0429 16:53:19.700659 14219 net.cpp:454] conv3_3 <- conv3_2
I0429 16:53:19.700676 14219 net.cpp:411] conv3_3 -> conv3_3
I0429 16:53:19.702906 14219 net.cpp:150] Setting up conv3_3
I0429 16:53:19.702944 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:19.702963 14219 net.cpp:165] Memory required for data: 1576730688
I0429 16:53:19.702981 14219 layer_factory.hpp:77] Creating layer ReLU3_3
I0429 16:53:19.703001 14219 net.cpp:106] Creating Layer ReLU3_3
I0429 16:53:19.703017 14219 net.cpp:454] ReLU3_3 <- conv3_3
I0429 16:53:19.703037 14219 net.cpp:397] ReLU3_3 -> conv3_3 (in-place)
I0429 16:53:19.703198 14219 net.cpp:150] Setting up ReLU3_3
I0429 16:53:19.703227 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:19.703241 14219 net.cpp:165] Memory required for data: 1628110912
I0429 16:53:19.703255 14219 layer_factory.hpp:77] Creating layer conv3_4
I0429 16:53:19.703275 14219 net.cpp:106] Creating Layer conv3_4
I0429 16:53:19.703294 14219 net.cpp:454] conv3_4 <- conv3_3
I0429 16:53:19.703315 14219 net.cpp:411] conv3_4 -> conv3_4
I0429 16:53:19.705648 14219 net.cpp:150] Setting up conv3_4
I0429 16:53:19.705685 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:19.705703 14219 net.cpp:165] Memory required for data: 1679491136
I0429 16:53:19.705720 14219 layer_factory.hpp:77] Creating layer ReLU3_4
I0429 16:53:19.705739 14219 net.cpp:106] Creating Layer ReLU3_4
I0429 16:53:19.705756 14219 net.cpp:454] ReLU3_4 <- conv3_4
I0429 16:53:19.705776 14219 net.cpp:397] ReLU3_4 -> conv3_4 (in-place)
I0429 16:53:19.706048 14219 net.cpp:150] Setting up ReLU3_4
I0429 16:53:19.706081 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:19.706107 14219 net.cpp:165] Memory required for data: 1730871360
I0429 16:53:19.706138 14219 layer_factory.hpp:77] Creating layer pool3
I0429 16:53:19.706157 14219 net.cpp:106] Creating Layer pool3
I0429 16:53:19.706173 14219 net.cpp:454] pool3 <- conv3_4
I0429 16:53:19.706192 14219 net.cpp:411] pool3 -> pool3
I0429 16:53:19.706248 14219 net.cpp:150] Setting up pool3
I0429 16:53:19.706271 14219 net.cpp:157] Top shape: 16 256 28 28 (3211264)
I0429 16:53:19.706286 14219 net.cpp:165] Memory required for data: 1743716416
I0429 16:53:19.706300 14219 layer_factory.hpp:77] Creating layer conv4_1
I0429 16:53:19.706321 14219 net.cpp:106] Creating Layer conv4_1
I0429 16:53:19.706339 14219 net.cpp:454] conv4_1 <- pool3
I0429 16:53:19.706356 14219 net.cpp:411] conv4_1 -> conv4_1
I0429 16:53:19.710321 14219 net.cpp:150] Setting up conv4_1
I0429 16:53:19.710361 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:19.710379 14219 net.cpp:165] Memory required for data: 1769406528
I0429 16:53:19.710400 14219 layer_factory.hpp:77] Creating layer ReLU4_1
I0429 16:53:19.710420 14219 net.cpp:106] Creating Layer ReLU4_1
I0429 16:53:19.710438 14219 net.cpp:454] ReLU4_1 <- conv4_1
I0429 16:53:19.710455 14219 net.cpp:397] ReLU4_1 -> conv4_1 (in-place)
I0429 16:53:19.710618 14219 net.cpp:150] Setting up ReLU4_1
I0429 16:53:19.710649 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:19.710664 14219 net.cpp:165] Memory required for data: 1795096640
I0429 16:53:19.710680 14219 layer_factory.hpp:77] Creating layer conv4_2
I0429 16:53:19.710697 14219 net.cpp:106] Creating Layer conv4_2
I0429 16:53:19.710714 14219 net.cpp:454] conv4_2 <- conv4_1
I0429 16:53:19.710733 14219 net.cpp:411] conv4_2 -> conv4_2
I0429 16:53:19.716701 14219 net.cpp:150] Setting up conv4_2
I0429 16:53:19.716742 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:19.716759 14219 net.cpp:165] Memory required for data: 1820786752
I0429 16:53:19.716778 14219 layer_factory.hpp:77] Creating layer ReLU4_2
I0429 16:53:19.716796 14219 net.cpp:106] Creating Layer ReLU4_2
I0429 16:53:19.716814 14219 net.cpp:454] ReLU4_2 <- conv4_2
I0429 16:53:19.716830 14219 net.cpp:397] ReLU4_2 -> conv4_2 (in-place)
I0429 16:53:19.716997 14219 net.cpp:150] Setting up ReLU4_2
I0429 16:53:19.717026 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:19.717041 14219 net.cpp:165] Memory required for data: 1846476864
I0429 16:53:19.717056 14219 layer_factory.hpp:77] Creating layer conv4_3
I0429 16:53:19.717077 14219 net.cpp:106] Creating Layer conv4_3
I0429 16:53:19.717093 14219 net.cpp:454] conv4_3 <- conv4_2
I0429 16:53:19.717111 14219 net.cpp:411] conv4_3 -> conv4_3
I0429 16:53:19.723283 14219 net.cpp:150] Setting up conv4_3
I0429 16:53:19.723320 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:19.723337 14219 net.cpp:165] Memory required for data: 1872166976
I0429 16:53:19.723356 14219 layer_factory.hpp:77] Creating layer ReLU4_3
I0429 16:53:19.723374 14219 net.cpp:106] Creating Layer ReLU4_3
I0429 16:53:19.723392 14219 net.cpp:454] ReLU4_3 <- conv4_3
I0429 16:53:19.723410 14219 net.cpp:397] ReLU4_3 -> conv4_3 (in-place)
I0429 16:53:19.723682 14219 net.cpp:150] Setting up ReLU4_3
I0429 16:53:19.723716 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:19.723731 14219 net.cpp:165] Memory required for data: 1897857088
I0429 16:53:19.723747 14219 layer_factory.hpp:77] Creating layer conv4_4
I0429 16:53:19.723768 14219 net.cpp:106] Creating Layer conv4_4
I0429 16:53:19.723788 14219 net.cpp:454] conv4_4 <- conv4_3
I0429 16:53:19.723804 14219 net.cpp:411] conv4_4 -> conv4_4
I0429 16:53:19.729786 14219 net.cpp:150] Setting up conv4_4
I0429 16:53:19.729827 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:19.729849 14219 net.cpp:165] Memory required for data: 1923547200
I0429 16:53:19.729869 14219 layer_factory.hpp:77] Creating layer ReLU4_4
I0429 16:53:19.729888 14219 net.cpp:106] Creating Layer ReLU4_4
I0429 16:53:19.729904 14219 net.cpp:454] ReLU4_4 <- conv4_4
I0429 16:53:19.729921 14219 net.cpp:397] ReLU4_4 -> conv4_4 (in-place)
I0429 16:53:19.730106 14219 net.cpp:150] Setting up ReLU4_4
I0429 16:53:19.730151 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:19.730167 14219 net.cpp:165] Memory required for data: 1949237312
I0429 16:53:19.730182 14219 layer_factory.hpp:77] Creating layer pool4
I0429 16:53:19.730201 14219 net.cpp:106] Creating Layer pool4
I0429 16:53:19.730219 14219 net.cpp:454] pool4 <- conv4_4
I0429 16:53:19.730237 14219 net.cpp:411] pool4 -> pool4
I0429 16:53:19.730294 14219 net.cpp:150] Setting up pool4
I0429 16:53:19.730317 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.730332 14219 net.cpp:165] Memory required for data: 1955659840
I0429 16:53:19.730346 14219 layer_factory.hpp:77] Creating layer conv5_1
I0429 16:53:19.730365 14219 net.cpp:106] Creating Layer conv5_1
I0429 16:53:19.730381 14219 net.cpp:454] conv5_1 <- pool4
I0429 16:53:19.730399 14219 net.cpp:411] conv5_1 -> conv5_1
I0429 16:53:19.736409 14219 net.cpp:150] Setting up conv5_1
I0429 16:53:19.736451 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.736469 14219 net.cpp:165] Memory required for data: 1962082368
I0429 16:53:19.736488 14219 layer_factory.hpp:77] Creating layer ReLU5_1
I0429 16:53:19.736507 14219 net.cpp:106] Creating Layer ReLU5_1
I0429 16:53:19.736523 14219 net.cpp:454] ReLU5_1 <- conv5_1
I0429 16:53:19.736542 14219 net.cpp:397] ReLU5_1 -> conv5_1 (in-place)
I0429 16:53:19.736841 14219 net.cpp:150] Setting up ReLU5_1
I0429 16:53:19.736876 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.736893 14219 net.cpp:165] Memory required for data: 1968504896
I0429 16:53:19.736918 14219 layer_factory.hpp:77] Creating layer conv5_2
I0429 16:53:19.736939 14219 net.cpp:106] Creating Layer conv5_2
I0429 16:53:19.736958 14219 net.cpp:454] conv5_2 <- conv5_1
I0429 16:53:19.736974 14219 net.cpp:411] conv5_2 -> conv5_2
I0429 16:53:19.742982 14219 net.cpp:150] Setting up conv5_2
I0429 16:53:19.743023 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.743041 14219 net.cpp:165] Memory required for data: 1974927424
I0429 16:53:19.743059 14219 layer_factory.hpp:77] Creating layer ReLU5_2
I0429 16:53:19.743083 14219 net.cpp:106] Creating Layer ReLU5_2
I0429 16:53:19.743099 14219 net.cpp:454] ReLU5_2 <- conv5_2
I0429 16:53:19.743118 14219 net.cpp:397] ReLU5_2 -> conv5_2 (in-place)
I0429 16:53:19.743386 14219 net.cpp:150] Setting up ReLU5_2
I0429 16:53:19.743419 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.743434 14219 net.cpp:165] Memory required for data: 1981349952
I0429 16:53:19.743449 14219 layer_factory.hpp:77] Creating layer conv5_3
I0429 16:53:19.743469 14219 net.cpp:106] Creating Layer conv5_3
I0429 16:53:19.743487 14219 net.cpp:454] conv5_3 <- conv5_2
I0429 16:53:19.743505 14219 net.cpp:411] conv5_3 -> conv5_3
I0429 16:53:19.749523 14219 net.cpp:150] Setting up conv5_3
I0429 16:53:19.749563 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.749580 14219 net.cpp:165] Memory required for data: 1987772480
I0429 16:53:19.749599 14219 layer_factory.hpp:77] Creating layer ReLU5_3
I0429 16:53:19.749617 14219 net.cpp:106] Creating Layer ReLU5_3
I0429 16:53:19.749634 14219 net.cpp:454] ReLU5_3 <- conv5_3
I0429 16:53:19.749653 14219 net.cpp:397] ReLU5_3 -> conv5_3 (in-place)
I0429 16:53:19.749819 14219 net.cpp:150] Setting up ReLU5_3
I0429 16:53:19.749850 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.749866 14219 net.cpp:165] Memory required for data: 1994195008
I0429 16:53:19.749881 14219 layer_factory.hpp:77] Creating layer conv5_4
I0429 16:53:19.749902 14219 net.cpp:106] Creating Layer conv5_4
I0429 16:53:19.749920 14219 net.cpp:454] conv5_4 <- conv5_3
I0429 16:53:19.749938 14219 net.cpp:411] conv5_4 -> conv5_4
I0429 16:53:19.755944 14219 net.cpp:150] Setting up conv5_4
I0429 16:53:19.755982 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.756000 14219 net.cpp:165] Memory required for data: 2000617536
I0429 16:53:19.756018 14219 layer_factory.hpp:77] Creating layer ReLU5_4
I0429 16:53:19.756060 14219 net.cpp:106] Creating Layer ReLU5_4
I0429 16:53:19.756099 14219 net.cpp:454] ReLU5_4 <- conv5_4
I0429 16:53:19.756116 14219 net.cpp:397] ReLU5_4 -> conv5_4 (in-place)
I0429 16:53:19.756283 14219 net.cpp:150] Setting up ReLU5_4
I0429 16:53:19.756314 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:19.756330 14219 net.cpp:165] Memory required for data: 2007040064
I0429 16:53:19.756345 14219 layer_factory.hpp:77] Creating layer pool5
I0429 16:53:19.756363 14219 net.cpp:106] Creating Layer pool5
I0429 16:53:19.756379 14219 net.cpp:454] pool5 <- conv5_4
I0429 16:53:19.756397 14219 net.cpp:411] pool5 -> pool5
I0429 16:53:19.756455 14219 net.cpp:150] Setting up pool5
I0429 16:53:19.756479 14219 net.cpp:157] Top shape: 16 512 7 7 (401408)
I0429 16:53:19.756494 14219 net.cpp:165] Memory required for data: 2008645696
I0429 16:53:19.756507 14219 layer_factory.hpp:77] Creating layer fc6
I0429 16:53:19.756531 14219 net.cpp:106] Creating Layer fc6
I0429 16:53:19.756549 14219 net.cpp:454] fc6 <- pool5
I0429 16:53:19.756566 14219 net.cpp:411] fc6 -> fc6
I0429 16:53:19.964439 14219 net.cpp:150] Setting up fc6
I0429 16:53:19.964540 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:19.964557 14219 net.cpp:165] Memory required for data: 2008907840
I0429 16:53:19.964588 14219 layer_factory.hpp:77] Creating layer ReLU6
I0429 16:53:19.964613 14219 net.cpp:106] Creating Layer ReLU6
I0429 16:53:19.964632 14219 net.cpp:454] ReLU6 <- fc6
I0429 16:53:19.964649 14219 net.cpp:397] ReLU6 -> fc6 (in-place)
I0429 16:53:19.965051 14219 net.cpp:150] Setting up ReLU6
I0429 16:53:19.965086 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:19.965103 14219 net.cpp:165] Memory required for data: 2009169984
I0429 16:53:19.965118 14219 layer_factory.hpp:77] Creating layer drop6
I0429 16:53:19.965140 14219 net.cpp:106] Creating Layer drop6
I0429 16:53:19.965158 14219 net.cpp:454] drop6 <- fc6
I0429 16:53:19.965175 14219 net.cpp:397] drop6 -> fc6 (in-place)
I0429 16:53:19.965229 14219 net.cpp:150] Setting up drop6
I0429 16:53:19.965251 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:19.965266 14219 net.cpp:165] Memory required for data: 2009432128
I0429 16:53:19.965281 14219 layer_factory.hpp:77] Creating layer fc7
I0429 16:53:19.965298 14219 net.cpp:106] Creating Layer fc7
I0429 16:53:19.965315 14219 net.cpp:454] fc7 <- fc6
I0429 16:53:19.965333 14219 net.cpp:411] fc7 -> fc7
I0429 16:53:20.001452 14219 net.cpp:150] Setting up fc7
I0429 16:53:20.001555 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.001572 14219 net.cpp:165] Memory required for data: 2009694272
I0429 16:53:20.001593 14219 layer_factory.hpp:77] Creating layer ReLU7
I0429 16:53:20.001616 14219 net.cpp:106] Creating Layer ReLU7
I0429 16:53:20.001633 14219 net.cpp:454] ReLU7 <- fc7
I0429 16:53:20.001654 14219 net.cpp:397] ReLU7 -> fc7 (in-place)
I0429 16:53:20.002053 14219 net.cpp:150] Setting up ReLU7
I0429 16:53:20.002087 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.002104 14219 net.cpp:165] Memory required for data: 2009956416
I0429 16:53:20.002120 14219 layer_factory.hpp:77] Creating layer drop7
I0429 16:53:20.002138 14219 net.cpp:106] Creating Layer drop7
I0429 16:53:20.002154 14219 net.cpp:454] drop7 <- fc7
I0429 16:53:20.002173 14219 net.cpp:397] drop7 -> fc7 (in-place)
I0429 16:53:20.002216 14219 net.cpp:150] Setting up drop7
I0429 16:53:20.002241 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.002256 14219 net.cpp:165] Memory required for data: 2010218560
I0429 16:53:20.002270 14219 layer_factory.hpp:77] Creating layer fc8_foodCAT
I0429 16:53:20.002288 14219 net.cpp:106] Creating Layer fc8_foodCAT
I0429 16:53:20.002303 14219 net.cpp:454] fc8_foodCAT <- fc7
I0429 16:53:20.002321 14219 net.cpp:411] fc8_foodCAT -> fc8_foodCAT
I0429 16:53:20.004565 14219 net.cpp:150] Setting up fc8_foodCAT
I0429 16:53:20.004598 14219 net.cpp:157] Top shape: 16 218 (3488)
I0429 16:53:20.004616 14219 net.cpp:165] Memory required for data: 2010232512
I0429 16:53:20.004632 14219 layer_factory.hpp:77] Creating layer loss
I0429 16:53:20.004678 14219 net.cpp:106] Creating Layer loss
I0429 16:53:20.004717 14219 net.cpp:454] loss <- fc8_foodCAT
I0429 16:53:20.004734 14219 net.cpp:454] loss <- label
I0429 16:53:20.004755 14219 net.cpp:411] loss -> loss/loss
I0429 16:53:20.004781 14219 layer_factory.hpp:77] Creating layer loss
I0429 16:53:20.005049 14219 net.cpp:150] Setting up loss
I0429 16:53:20.005080 14219 net.cpp:157] Top shape: (1)
I0429 16:53:20.005095 14219 net.cpp:160]     with loss weight 1
I0429 16:53:20.005161 14219 net.cpp:165] Memory required for data: 2010232516
I0429 16:53:20.005175 14219 net.cpp:226] loss needs backward computation.
I0429 16:53:20.005190 14219 net.cpp:226] fc8_foodCAT needs backward computation.
I0429 16:53:20.005205 14219 net.cpp:226] drop7 needs backward computation.
I0429 16:53:20.005219 14219 net.cpp:226] ReLU7 needs backward computation.
I0429 16:53:20.005233 14219 net.cpp:226] fc7 needs backward computation.
I0429 16:53:20.005246 14219 net.cpp:226] drop6 needs backward computation.
I0429 16:53:20.005260 14219 net.cpp:226] ReLU6 needs backward computation.
I0429 16:53:20.005273 14219 net.cpp:226] fc6 needs backward computation.
I0429 16:53:20.005287 14219 net.cpp:226] pool5 needs backward computation.
I0429 16:53:20.005302 14219 net.cpp:226] ReLU5_4 needs backward computation.
I0429 16:53:20.005316 14219 net.cpp:226] conv5_4 needs backward computation.
I0429 16:53:20.005329 14219 net.cpp:226] ReLU5_3 needs backward computation.
I0429 16:53:20.005343 14219 net.cpp:226] conv5_3 needs backward computation.
I0429 16:53:20.005357 14219 net.cpp:226] ReLU5_2 needs backward computation.
I0429 16:53:20.005372 14219 net.cpp:226] conv5_2 needs backward computation.
I0429 16:53:20.005385 14219 net.cpp:226] ReLU5_1 needs backward computation.
I0429 16:53:20.005399 14219 net.cpp:226] conv5_1 needs backward computation.
I0429 16:53:20.005414 14219 net.cpp:226] pool4 needs backward computation.
I0429 16:53:20.005427 14219 net.cpp:226] ReLU4_4 needs backward computation.
I0429 16:53:20.005441 14219 net.cpp:226] conv4_4 needs backward computation.
I0429 16:53:20.005455 14219 net.cpp:226] ReLU4_3 needs backward computation.
I0429 16:53:20.005468 14219 net.cpp:226] conv4_3 needs backward computation.
I0429 16:53:20.005482 14219 net.cpp:226] ReLU4_2 needs backward computation.
I0429 16:53:20.005496 14219 net.cpp:226] conv4_2 needs backward computation.
I0429 16:53:20.005511 14219 net.cpp:226] ReLU4_1 needs backward computation.
I0429 16:53:20.005523 14219 net.cpp:226] conv4_1 needs backward computation.
I0429 16:53:20.005537 14219 net.cpp:226] pool3 needs backward computation.
I0429 16:53:20.005551 14219 net.cpp:226] ReLU3_4 needs backward computation.
I0429 16:53:20.005565 14219 net.cpp:226] conv3_4 needs backward computation.
I0429 16:53:20.005579 14219 net.cpp:226] ReLU3_3 needs backward computation.
I0429 16:53:20.005594 14219 net.cpp:226] conv3_3 needs backward computation.
I0429 16:53:20.005606 14219 net.cpp:226] ReLU3_2 needs backward computation.
I0429 16:53:20.005620 14219 net.cpp:226] conv3_2 needs backward computation.
I0429 16:53:20.005635 14219 net.cpp:226] ReLU3_1 needs backward computation.
I0429 16:53:20.005648 14219 net.cpp:226] conv3_1 needs backward computation.
I0429 16:53:20.005662 14219 net.cpp:226] pool2 needs backward computation.
I0429 16:53:20.005676 14219 net.cpp:226] ReLU2_2 needs backward computation.
I0429 16:53:20.005689 14219 net.cpp:226] conv2_2 needs backward computation.
I0429 16:53:20.005703 14219 net.cpp:226] ReLU2_1 needs backward computation.
I0429 16:53:20.005717 14219 net.cpp:226] conv2_1 needs backward computation.
I0429 16:53:20.005731 14219 net.cpp:226] pool1 needs backward computation.
I0429 16:53:20.005745 14219 net.cpp:226] ReLU1_2 needs backward computation.
I0429 16:53:20.005759 14219 net.cpp:226] conv1_2 needs backward computation.
I0429 16:53:20.005774 14219 net.cpp:226] ReLU1_1 needs backward computation.
I0429 16:53:20.005786 14219 net.cpp:226] conv1_1 needs backward computation.
I0429 16:53:20.005801 14219 net.cpp:228] data does not need backward computation.
I0429 16:53:20.005825 14219 net.cpp:270] This network produces output loss/loss
I0429 16:53:20.005879 14219 net.cpp:283] Network initialization done.
I0429 16:53:20.007833 14219 solver.cpp:181] Creating test net (#0) specified by net file: models/foodCAT_VGG_ILSVRC_19_layers/CLUSTER/VGG_ILSVRC_19_layers_train_val.prototxt
I0429 16:53:20.007928 14219 net.cpp:322] The NetState phase (1) differed from the phase (0) specified by a rule in layer data
I0429 16:53:20.008182 14219 net.cpp:49] Initializing net from parameters: 
name: "foodCAT_VGG_ILSVRC_19_layer"
state {
  phase: TEST
}
layer {
  name: "data"
  type: "ImageData"
  top: "data"
  top: "label"
  include {
    phase: TEST
  }
  transform_param {
    mirror: false
    crop_size: 224
    mean_value: 104
    mean_value: 117
    mean_value: 123
  }
  image_data_param {
    source: "foodCAT_CLUSTER/val.txt"
    batch_size: 16
    shuffle: true
    new_height: 256
    new_width: 256
  }
}
layer {
  name: "conv1_1"
  type: "Convolution"
  bottom: "data"
  top: "conv1_1"
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU1_1"
  type: "ReLU"
  bottom: "conv1_1"
  top: "conv1_1"
}
layer {
  name: "conv1_2"
  type: "Convolution"
  bottom: "conv1_1"
  top: "conv1_2"
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU1_2"
  type: "ReLU"
  bottom: "conv1_2"
  top: "conv1_2"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1_2"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2_1"
  type: "Convolution"
  bottom: "pool1"
  top: "conv2_1"
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU2_1"
  type: "ReLU"
  bottom: "conv2_1"
  top: "conv2_1"
}
layer {
  name: "conv2_2"
  type: "Convolution"
  bottom: "conv2_1"
  top: "conv2_2"
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU2_2"
  type: "ReLU"
  bottom: "conv2_2"
  top: "conv2_2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2_2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv3_1"
  type: "Convolution"
  bottom: "pool2"
  top: "conv3_1"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU3_1"
  type: "ReLU"
  bottom: "conv3_1"
  top: "conv3_1"
}
layer {
  name: "conv3_2"
  type: "Convolution"
  bottom: "conv3_1"
  top: "conv3_2"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU3_2"
  type: "ReLU"
  bottom: "conv3_2"
  top: "conv3_2"
}
layer {
  name: "conv3_3"
  type: "Convolution"
  bottom: "conv3_2"
  top: "conv3_3"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU3_3"
  type: "ReLU"
  bottom: "conv3_3"
  top: "conv3_3"
}
layer {
  name: "conv3_4"
  type: "Convolution"
  bottom: "conv3_3"
  top: "conv3_4"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU3_4"
  type: "ReLU"
  bottom: "conv3_4"
  top: "conv3_4"
}
layer {
  name: "pool3"
  type: "Pooling"
  bottom: "conv3_4"
  top: "pool3"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv4_1"
  type: "Convolution"
  bottom: "pool3"
  top: "conv4_1"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU4_1"
  type: "ReLU"
  bottom: "conv4_1"
  top: "conv4_1"
}
layer {
  name: "conv4_2"
  type: "Convolution"
  bottom: "conv4_1"
  top: "conv4_2"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU4_2"
  type: "ReLU"
  bottom: "conv4_2"
  top: "conv4_2"
}
layer {
  name: "conv4_3"
  type: "Convolution"
  bottom: "conv4_2"
  top: "conv4_3"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU4_3"
  type: "ReLU"
  bottom: "conv4_3"
  top: "conv4_3"
}
layer {
  name: "conv4_4"
  type: "Convolution"
  bottom: "conv4_3"
  top: "conv4_4"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU4_4"
  type: "ReLU"
  bottom: "conv4_4"
  top: "conv4_4"
}
layer {
  name: "pool4"
  type: "Pooling"
  bottom: "conv4_4"
  top: "pool4"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv5_1"
  type: "Convolution"
  bottom: "pool4"
  top: "conv5_1"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU5_1"
  type: "ReLU"
  bottom: "conv5_1"
  top: "conv5_1"
}
layer {
  name: "conv5_2"
  type: "Convolution"
  bottom: "conv5_1"
  top: "conv5_2"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU5_2"
  type: "ReLU"
  bottom: "conv5_2"
  top: "conv5_2"
}
layer {
  name: "conv5_3"
  type: "Convolution"
  bottom: "conv5_2"
  top: "conv5_3"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU5_3"
  type: "ReLU"
  bottom: "conv5_3"
  top: "conv5_3"
}
layer {
  name: "conv5_4"
  type: "Convolution"
  bottom: "conv5_3"
  top: "conv5_4"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
  }
}
layer {
  name: "ReLU5_4"
  type: "ReLU"
  bottom: "conv5_4"
  top: "conv5_4"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5_4"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "ReLU6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
  }
}
layer {
  name: "ReLU7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.5
  }
}
layer {
  name: "fc8_foodCAT"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8_foodCAT"
  inner_product_param {
    num_output: 218
  }
}
layer {
  name: "loss"
  type: "SoftmaxWithLoss"
  bottom: "fc8_foodCAT"
  bottom: "label"
  top: "loss/loss"
}
layer {
  name: "accuracy/top1"
  type: "Accuracy"
  bottom: "fc8_foodCAT"
  bottom: "label"
  top: "accuracy@1"
  include {
    phase: TEST
  }
  accuracy_param {
    top_k: 1
  }
}
layer {
  name: "accuracy/top5"
  type: "Accuracy"
  bottom: "fc8_foodCAT"
  bottom: "label"
  top: "accuracy@5"
  include {
    phase: TEST
  }
  accuracy_param {
    top_k: 5
  }
}
I0429 16:53:20.008360 14219 layer_factory.hpp:77] Creating layer data
I0429 16:53:20.008396 14219 net.cpp:106] Creating Layer data
I0429 16:53:20.008419 14219 net.cpp:411] data -> data
I0429 16:53:20.008440 14219 net.cpp:411] data -> label
I0429 16:53:20.008462 14219 image_data_layer.cpp:38] Opening file foodCAT_CLUSTER/val.txt
I0429 16:53:20.018503 14219 image_data_layer.cpp:48] Shuffling data
I0429 16:53:20.019402 14219 image_data_layer.cpp:53] A total of 14649 images.
I0429 16:53:20.040328 14219 image_data_layer.cpp:80] output data size: 16,3,224,224
I0429 16:53:20.056788 14219 net.cpp:150] Setting up data
I0429 16:53:20.056854 14219 net.cpp:157] Top shape: 16 3 224 224 (2408448)
I0429 16:53:20.056877 14219 net.cpp:157] Top shape: 16 (16)
I0429 16:53:20.056893 14219 net.cpp:165] Memory required for data: 9633856
I0429 16:53:20.056910 14219 layer_factory.hpp:77] Creating layer label_data_1_split
I0429 16:53:20.056932 14219 net.cpp:106] Creating Layer label_data_1_split
I0429 16:53:20.056951 14219 net.cpp:454] label_data_1_split <- label
I0429 16:53:20.056968 14219 net.cpp:411] label_data_1_split -> label_data_1_split_0
I0429 16:53:20.056990 14219 net.cpp:411] label_data_1_split -> label_data_1_split_1
I0429 16:53:20.057009 14219 net.cpp:411] label_data_1_split -> label_data_1_split_2
I0429 16:53:20.057080 14219 net.cpp:150] Setting up label_data_1_split
I0429 16:53:20.057117 14219 net.cpp:157] Top shape: 16 (16)
I0429 16:53:20.057147 14219 net.cpp:157] Top shape: 16 (16)
I0429 16:53:20.057164 14219 net.cpp:157] Top shape: 16 (16)
I0429 16:53:20.057179 14219 net.cpp:165] Memory required for data: 9634048
I0429 16:53:20.057194 14219 layer_factory.hpp:77] Creating layer conv1_1
I0429 16:53:20.057215 14219 net.cpp:106] Creating Layer conv1_1
I0429 16:53:20.057234 14219 net.cpp:454] conv1_1 <- data
I0429 16:53:20.057251 14219 net.cpp:411] conv1_1 -> conv1_1
I0429 16:53:20.058542 14219 net.cpp:150] Setting up conv1_1
I0429 16:53:20.058593 14219 net.cpp:157] Top shape: 16 64 224 224 (51380224)
I0429 16:53:20.058634 14219 net.cpp:165] Memory required for data: 215154944
I0429 16:53:20.058668 14219 layer_factory.hpp:77] Creating layer ReLU1_1
I0429 16:53:20.058701 14219 net.cpp:106] Creating Layer ReLU1_1
I0429 16:53:20.058720 14219 net.cpp:454] ReLU1_1 <- conv1_1
I0429 16:53:20.058740 14219 net.cpp:397] ReLU1_1 -> conv1_1 (in-place)
I0429 16:53:20.058948 14219 net.cpp:150] Setting up ReLU1_1
I0429 16:53:20.058979 14219 net.cpp:157] Top shape: 16 64 224 224 (51380224)
I0429 16:53:20.058995 14219 net.cpp:165] Memory required for data: 420675840
I0429 16:53:20.059010 14219 layer_factory.hpp:77] Creating layer conv1_2
I0429 16:53:20.059031 14219 net.cpp:106] Creating Layer conv1_2
I0429 16:53:20.059048 14219 net.cpp:454] conv1_2 <- conv1_1
I0429 16:53:20.059067 14219 net.cpp:411] conv1_2 -> conv1_2
I0429 16:53:20.060523 14219 net.cpp:150] Setting up conv1_2
I0429 16:53:20.060562 14219 net.cpp:157] Top shape: 16 64 224 224 (51380224)
I0429 16:53:20.060581 14219 net.cpp:165] Memory required for data: 626196736
I0429 16:53:20.060602 14219 layer_factory.hpp:77] Creating layer ReLU1_2
I0429 16:53:20.060623 14219 net.cpp:106] Creating Layer ReLU1_2
I0429 16:53:20.060641 14219 net.cpp:454] ReLU1_2 <- conv1_2
I0429 16:53:20.060658 14219 net.cpp:397] ReLU1_2 -> conv1_2 (in-place)
I0429 16:53:20.060986 14219 net.cpp:150] Setting up ReLU1_2
I0429 16:53:20.061020 14219 net.cpp:157] Top shape: 16 64 224 224 (51380224)
I0429 16:53:20.061038 14219 net.cpp:165] Memory required for data: 831717632
I0429 16:53:20.061054 14219 layer_factory.hpp:77] Creating layer pool1
I0429 16:53:20.061074 14219 net.cpp:106] Creating Layer pool1
I0429 16:53:20.061090 14219 net.cpp:454] pool1 <- conv1_2
I0429 16:53:20.061108 14219 net.cpp:411] pool1 -> pool1
I0429 16:53:20.061167 14219 net.cpp:150] Setting up pool1
I0429 16:53:20.061202 14219 net.cpp:157] Top shape: 16 64 112 112 (12845056)
I0429 16:53:20.061239 14219 net.cpp:165] Memory required for data: 883097856
I0429 16:53:20.061255 14219 layer_factory.hpp:77] Creating layer conv2_1
I0429 16:53:20.061295 14219 net.cpp:106] Creating Layer conv2_1
I0429 16:53:20.061334 14219 net.cpp:454] conv2_1 <- pool1
I0429 16:53:20.061364 14219 net.cpp:411] conv2_1 -> conv2_1
I0429 16:53:20.064149 14219 net.cpp:150] Setting up conv2_1
I0429 16:53:20.064193 14219 net.cpp:157] Top shape: 16 128 112 112 (25690112)
I0429 16:53:20.064213 14219 net.cpp:165] Memory required for data: 985858304
I0429 16:53:20.064235 14219 layer_factory.hpp:77] Creating layer ReLU2_1
I0429 16:53:20.064257 14219 net.cpp:106] Creating Layer ReLU2_1
I0429 16:53:20.064276 14219 net.cpp:454] ReLU2_1 <- conv2_1
I0429 16:53:20.064294 14219 net.cpp:397] ReLU2_1 -> conv2_1 (in-place)
I0429 16:53:20.064465 14219 net.cpp:150] Setting up ReLU2_1
I0429 16:53:20.064494 14219 net.cpp:157] Top shape: 16 128 112 112 (25690112)
I0429 16:53:20.064512 14219 net.cpp:165] Memory required for data: 1088618752
I0429 16:53:20.064527 14219 layer_factory.hpp:77] Creating layer conv2_2
I0429 16:53:20.064546 14219 net.cpp:106] Creating Layer conv2_2
I0429 16:53:20.064564 14219 net.cpp:454] conv2_2 <- conv2_1
I0429 16:53:20.064584 14219 net.cpp:411] conv2_2 -> conv2_2
I0429 16:53:20.065587 14219 net.cpp:150] Setting up conv2_2
I0429 16:53:20.065624 14219 net.cpp:157] Top shape: 16 128 112 112 (25690112)
I0429 16:53:20.065641 14219 net.cpp:165] Memory required for data: 1191379200
I0429 16:53:20.065660 14219 layer_factory.hpp:77] Creating layer ReLU2_2
I0429 16:53:20.065693 14219 net.cpp:106] Creating Layer ReLU2_2
I0429 16:53:20.065724 14219 net.cpp:454] ReLU2_2 <- conv2_2
I0429 16:53:20.065743 14219 net.cpp:397] ReLU2_2 -> conv2_2 (in-place)
I0429 16:53:20.065959 14219 net.cpp:150] Setting up ReLU2_2
I0429 16:53:20.065989 14219 net.cpp:157] Top shape: 16 128 112 112 (25690112)
I0429 16:53:20.066005 14219 net.cpp:165] Memory required for data: 1294139648
I0429 16:53:20.066021 14219 layer_factory.hpp:77] Creating layer pool2
I0429 16:53:20.066040 14219 net.cpp:106] Creating Layer pool2
I0429 16:53:20.066057 14219 net.cpp:454] pool2 <- conv2_2
I0429 16:53:20.066076 14219 net.cpp:411] pool2 -> pool2
I0429 16:53:20.066133 14219 net.cpp:150] Setting up pool2
I0429 16:53:20.066156 14219 net.cpp:157] Top shape: 16 128 56 56 (6422528)
I0429 16:53:20.066171 14219 net.cpp:165] Memory required for data: 1319829760
I0429 16:53:20.066186 14219 layer_factory.hpp:77] Creating layer conv3_1
I0429 16:53:20.066216 14219 net.cpp:106] Creating Layer conv3_1
I0429 16:53:20.066246 14219 net.cpp:454] conv3_1 <- pool2
I0429 16:53:20.066263 14219 net.cpp:411] conv3_1 -> conv3_1
I0429 16:53:20.068306 14219 net.cpp:150] Setting up conv3_1
I0429 16:53:20.068346 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:20.068364 14219 net.cpp:165] Memory required for data: 1371209984
I0429 16:53:20.068385 14219 layer_factory.hpp:77] Creating layer ReLU3_1
I0429 16:53:20.068405 14219 net.cpp:106] Creating Layer ReLU3_1
I0429 16:53:20.068423 14219 net.cpp:454] ReLU3_1 <- conv3_1
I0429 16:53:20.068439 14219 net.cpp:397] ReLU3_1 -> conv3_1 (in-place)
I0429 16:53:20.068711 14219 net.cpp:150] Setting up ReLU3_1
I0429 16:53:20.068743 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:20.068759 14219 net.cpp:165] Memory required for data: 1422590208
I0429 16:53:20.068775 14219 layer_factory.hpp:77] Creating layer conv3_2
I0429 16:53:20.068795 14219 net.cpp:106] Creating Layer conv3_2
I0429 16:53:20.068814 14219 net.cpp:454] conv3_2 <- conv3_1
I0429 16:53:20.068858 14219 net.cpp:411] conv3_2 -> conv3_2
I0429 16:53:20.071300 14219 net.cpp:150] Setting up conv3_2
I0429 16:53:20.071339 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:20.071358 14219 net.cpp:165] Memory required for data: 1473970432
I0429 16:53:20.071377 14219 layer_factory.hpp:77] Creating layer ReLU3_2
I0429 16:53:20.071394 14219 net.cpp:106] Creating Layer ReLU3_2
I0429 16:53:20.071413 14219 net.cpp:454] ReLU3_2 <- conv3_2
I0429 16:53:20.071429 14219 net.cpp:397] ReLU3_2 -> conv3_2 (in-place)
I0429 16:53:20.071602 14219 net.cpp:150] Setting up ReLU3_2
I0429 16:53:20.071630 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:20.071645 14219 net.cpp:165] Memory required for data: 1525350656
I0429 16:53:20.071660 14219 layer_factory.hpp:77] Creating layer conv3_3
I0429 16:53:20.071684 14219 net.cpp:106] Creating Layer conv3_3
I0429 16:53:20.071702 14219 net.cpp:454] conv3_3 <- conv3_2
I0429 16:53:20.071722 14219 net.cpp:411] conv3_3 -> conv3_3
I0429 16:53:20.074134 14219 net.cpp:150] Setting up conv3_3
I0429 16:53:20.074172 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:20.074190 14219 net.cpp:165] Memory required for data: 1576730880
I0429 16:53:20.074208 14219 layer_factory.hpp:77] Creating layer ReLU3_3
I0429 16:53:20.074229 14219 net.cpp:106] Creating Layer ReLU3_3
I0429 16:53:20.074245 14219 net.cpp:454] ReLU3_3 <- conv3_3
I0429 16:53:20.074262 14219 net.cpp:397] ReLU3_3 -> conv3_3 (in-place)
I0429 16:53:20.074431 14219 net.cpp:150] Setting up ReLU3_3
I0429 16:53:20.074460 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:20.074476 14219 net.cpp:165] Memory required for data: 1628111104
I0429 16:53:20.074491 14219 layer_factory.hpp:77] Creating layer conv3_4
I0429 16:53:20.074509 14219 net.cpp:106] Creating Layer conv3_4
I0429 16:53:20.074525 14219 net.cpp:454] conv3_4 <- conv3_3
I0429 16:53:20.074544 14219 net.cpp:411] conv3_4 -> conv3_4
I0429 16:53:20.076813 14219 net.cpp:150] Setting up conv3_4
I0429 16:53:20.076855 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:20.076884 14219 net.cpp:165] Memory required for data: 1679491328
I0429 16:53:20.076916 14219 layer_factory.hpp:77] Creating layer ReLU3_4
I0429 16:53:20.076936 14219 net.cpp:106] Creating Layer ReLU3_4
I0429 16:53:20.076952 14219 net.cpp:454] ReLU3_4 <- conv3_4
I0429 16:53:20.076969 14219 net.cpp:397] ReLU3_4 -> conv3_4 (in-place)
I0429 16:53:20.077250 14219 net.cpp:150] Setting up ReLU3_4
I0429 16:53:20.077283 14219 net.cpp:157] Top shape: 16 256 56 56 (12845056)
I0429 16:53:20.077301 14219 net.cpp:165] Memory required for data: 1730871552
I0429 16:53:20.077316 14219 layer_factory.hpp:77] Creating layer pool3
I0429 16:53:20.077332 14219 net.cpp:106] Creating Layer pool3
I0429 16:53:20.077349 14219 net.cpp:454] pool3 <- conv3_4
I0429 16:53:20.077366 14219 net.cpp:411] pool3 -> pool3
I0429 16:53:20.077428 14219 net.cpp:150] Setting up pool3
I0429 16:53:20.077451 14219 net.cpp:157] Top shape: 16 256 28 28 (3211264)
I0429 16:53:20.077466 14219 net.cpp:165] Memory required for data: 1743716608
I0429 16:53:20.077481 14219 layer_factory.hpp:77] Creating layer conv4_1
I0429 16:53:20.077500 14219 net.cpp:106] Creating Layer conv4_1
I0429 16:53:20.077517 14219 net.cpp:454] conv4_1 <- pool3
I0429 16:53:20.077535 14219 net.cpp:411] conv4_1 -> conv4_1
I0429 16:53:20.081061 14219 net.cpp:150] Setting up conv4_1
I0429 16:53:20.081102 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:20.081120 14219 net.cpp:165] Memory required for data: 1769406720
I0429 16:53:20.081141 14219 layer_factory.hpp:77] Creating layer ReLU4_1
I0429 16:53:20.081162 14219 net.cpp:106] Creating Layer ReLU4_1
I0429 16:53:20.081181 14219 net.cpp:454] ReLU4_1 <- conv4_1
I0429 16:53:20.081197 14219 net.cpp:397] ReLU4_1 -> conv4_1 (in-place)
I0429 16:53:20.081368 14219 net.cpp:150] Setting up ReLU4_1
I0429 16:53:20.081398 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:20.081413 14219 net.cpp:165] Memory required for data: 1795096832
I0429 16:53:20.081426 14219 layer_factory.hpp:77] Creating layer conv4_2
I0429 16:53:20.081446 14219 net.cpp:106] Creating Layer conv4_2
I0429 16:53:20.081465 14219 net.cpp:454] conv4_2 <- conv4_1
I0429 16:53:20.081483 14219 net.cpp:411] conv4_2 -> conv4_2
I0429 16:53:20.088441 14219 net.cpp:150] Setting up conv4_2
I0429 16:53:20.088495 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:20.088524 14219 net.cpp:165] Memory required for data: 1820786944
I0429 16:53:20.088557 14219 layer_factory.hpp:77] Creating layer ReLU4_2
I0429 16:53:20.088577 14219 net.cpp:106] Creating Layer ReLU4_2
I0429 16:53:20.088606 14219 net.cpp:454] ReLU4_2 <- conv4_2
I0429 16:53:20.088626 14219 net.cpp:397] ReLU4_2 -> conv4_2 (in-place)
I0429 16:53:20.088851 14219 net.cpp:150] Setting up ReLU4_2
I0429 16:53:20.088914 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:20.088932 14219 net.cpp:165] Memory required for data: 1846477056
I0429 16:53:20.088949 14219 layer_factory.hpp:77] Creating layer conv4_3
I0429 16:53:20.088969 14219 net.cpp:106] Creating Layer conv4_3
I0429 16:53:20.088987 14219 net.cpp:454] conv4_3 <- conv4_2
I0429 16:53:20.089018 14219 net.cpp:411] conv4_3 -> conv4_3
I0429 16:53:20.095268 14219 net.cpp:150] Setting up conv4_3
I0429 16:53:20.095309 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:20.095325 14219 net.cpp:165] Memory required for data: 1872167168
I0429 16:53:20.095345 14219 layer_factory.hpp:77] Creating layer ReLU4_3
I0429 16:53:20.095362 14219 net.cpp:106] Creating Layer ReLU4_3
I0429 16:53:20.095379 14219 net.cpp:454] ReLU4_3 <- conv4_3
I0429 16:53:20.095398 14219 net.cpp:397] ReLU4_3 -> conv4_3 (in-place)
I0429 16:53:20.095676 14219 net.cpp:150] Setting up ReLU4_3
I0429 16:53:20.095708 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:20.095724 14219 net.cpp:165] Memory required for data: 1897857280
I0429 16:53:20.095739 14219 layer_factory.hpp:77] Creating layer conv4_4
I0429 16:53:20.095762 14219 net.cpp:106] Creating Layer conv4_4
I0429 16:53:20.095779 14219 net.cpp:454] conv4_4 <- conv4_3
I0429 16:53:20.095810 14219 net.cpp:411] conv4_4 -> conv4_4
I0429 16:53:20.101881 14219 net.cpp:150] Setting up conv4_4
I0429 16:53:20.101919 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:20.101936 14219 net.cpp:165] Memory required for data: 1923547392
I0429 16:53:20.101954 14219 layer_factory.hpp:77] Creating layer ReLU4_4
I0429 16:53:20.101974 14219 net.cpp:106] Creating Layer ReLU4_4
I0429 16:53:20.101989 14219 net.cpp:454] ReLU4_4 <- conv4_4
I0429 16:53:20.102008 14219 net.cpp:397] ReLU4_4 -> conv4_4 (in-place)
I0429 16:53:20.102180 14219 net.cpp:150] Setting up ReLU4_4
I0429 16:53:20.102208 14219 net.cpp:157] Top shape: 16 512 28 28 (6422528)
I0429 16:53:20.102223 14219 net.cpp:165] Memory required for data: 1949237504
I0429 16:53:20.102238 14219 layer_factory.hpp:77] Creating layer pool4
I0429 16:53:20.102258 14219 net.cpp:106] Creating Layer pool4
I0429 16:53:20.102274 14219 net.cpp:454] pool4 <- conv4_4
I0429 16:53:20.102291 14219 net.cpp:411] pool4 -> pool4
I0429 16:53:20.102355 14219 net.cpp:150] Setting up pool4
I0429 16:53:20.102377 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.102392 14219 net.cpp:165] Memory required for data: 1955660032
I0429 16:53:20.102406 14219 layer_factory.hpp:77] Creating layer conv5_1
I0429 16:53:20.102427 14219 net.cpp:106] Creating Layer conv5_1
I0429 16:53:20.102443 14219 net.cpp:454] conv5_1 <- pool4
I0429 16:53:20.102459 14219 net.cpp:411] conv5_1 -> conv5_1
I0429 16:53:20.109215 14219 net.cpp:150] Setting up conv5_1
I0429 16:53:20.109258 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.109277 14219 net.cpp:165] Memory required for data: 1962082560
I0429 16:53:20.109319 14219 layer_factory.hpp:77] Creating layer ReLU5_1
I0429 16:53:20.109343 14219 net.cpp:106] Creating Layer ReLU5_1
I0429 16:53:20.109376 14219 net.cpp:454] ReLU5_1 <- conv5_1
I0429 16:53:20.109405 14219 net.cpp:397] ReLU5_1 -> conv5_1 (in-place)
I0429 16:53:20.109663 14219 net.cpp:150] Setting up ReLU5_1
I0429 16:53:20.109694 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.109735 14219 net.cpp:165] Memory required for data: 1968505088
I0429 16:53:20.109750 14219 layer_factory.hpp:77] Creating layer conv5_2
I0429 16:53:20.109778 14219 net.cpp:106] Creating Layer conv5_2
I0429 16:53:20.109819 14219 net.cpp:454] conv5_2 <- conv5_1
I0429 16:53:20.109843 14219 net.cpp:411] conv5_2 -> conv5_2
I0429 16:53:20.116482 14219 net.cpp:150] Setting up conv5_2
I0429 16:53:20.116520 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.116539 14219 net.cpp:165] Memory required for data: 1974927616
I0429 16:53:20.116556 14219 layer_factory.hpp:77] Creating layer ReLU5_2
I0429 16:53:20.116577 14219 net.cpp:106] Creating Layer ReLU5_2
I0429 16:53:20.116595 14219 net.cpp:454] ReLU5_2 <- conv5_2
I0429 16:53:20.116611 14219 net.cpp:397] ReLU5_2 -> conv5_2 (in-place)
I0429 16:53:20.116950 14219 net.cpp:150] Setting up ReLU5_2
I0429 16:53:20.116986 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.117002 14219 net.cpp:165] Memory required for data: 1981350144
I0429 16:53:20.117017 14219 layer_factory.hpp:77] Creating layer conv5_3
I0429 16:53:20.117038 14219 net.cpp:106] Creating Layer conv5_3
I0429 16:53:20.117054 14219 net.cpp:454] conv5_3 <- conv5_2
I0429 16:53:20.117074 14219 net.cpp:411] conv5_3 -> conv5_3
I0429 16:53:20.123415 14219 net.cpp:150] Setting up conv5_3
I0429 16:53:20.123456 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.123474 14219 net.cpp:165] Memory required for data: 1987772672
I0429 16:53:20.123492 14219 layer_factory.hpp:77] Creating layer ReLU5_3
I0429 16:53:20.123513 14219 net.cpp:106] Creating Layer ReLU5_3
I0429 16:53:20.123531 14219 net.cpp:454] ReLU5_3 <- conv5_3
I0429 16:53:20.123548 14219 net.cpp:397] ReLU5_3 -> conv5_3 (in-place)
I0429 16:53:20.123728 14219 net.cpp:150] Setting up ReLU5_3
I0429 16:53:20.123757 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.123774 14219 net.cpp:165] Memory required for data: 1994195200
I0429 16:53:20.123787 14219 layer_factory.hpp:77] Creating layer conv5_4
I0429 16:53:20.123826 14219 net.cpp:106] Creating Layer conv5_4
I0429 16:53:20.123869 14219 net.cpp:454] conv5_4 <- conv5_3
I0429 16:53:20.123890 14219 net.cpp:411] conv5_4 -> conv5_4
I0429 16:53:20.129984 14219 net.cpp:150] Setting up conv5_4
I0429 16:53:20.130025 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.130043 14219 net.cpp:165] Memory required for data: 2000617728
I0429 16:53:20.130062 14219 layer_factory.hpp:77] Creating layer ReLU5_4
I0429 16:53:20.130081 14219 net.cpp:106] Creating Layer ReLU5_4
I0429 16:53:20.130098 14219 net.cpp:454] ReLU5_4 <- conv5_4
I0429 16:53:20.130115 14219 net.cpp:397] ReLU5_4 -> conv5_4 (in-place)
I0429 16:53:20.130291 14219 net.cpp:150] Setting up ReLU5_4
I0429 16:53:20.130319 14219 net.cpp:157] Top shape: 16 512 14 14 (1605632)
I0429 16:53:20.130334 14219 net.cpp:165] Memory required for data: 2007040256
I0429 16:53:20.130349 14219 layer_factory.hpp:77] Creating layer pool5
I0429 16:53:20.130367 14219 net.cpp:106] Creating Layer pool5
I0429 16:53:20.130384 14219 net.cpp:454] pool5 <- conv5_4
I0429 16:53:20.130403 14219 net.cpp:411] pool5 -> pool5
I0429 16:53:20.130468 14219 net.cpp:150] Setting up pool5
I0429 16:53:20.130492 14219 net.cpp:157] Top shape: 16 512 7 7 (401408)
I0429 16:53:20.130506 14219 net.cpp:165] Memory required for data: 2008645888
I0429 16:53:20.130520 14219 layer_factory.hpp:77] Creating layer fc6
I0429 16:53:20.130540 14219 net.cpp:106] Creating Layer fc6
I0429 16:53:20.130558 14219 net.cpp:454] fc6 <- pool5
I0429 16:53:20.130574 14219 net.cpp:411] fc6 -> fc6
I0429 16:53:20.346807 14219 net.cpp:150] Setting up fc6
I0429 16:53:20.346910 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.346930 14219 net.cpp:165] Memory required for data: 2008908032
I0429 16:53:20.346961 14219 layer_factory.hpp:77] Creating layer ReLU6
I0429 16:53:20.346987 14219 net.cpp:106] Creating Layer ReLU6
I0429 16:53:20.347007 14219 net.cpp:454] ReLU6 <- fc6
I0429 16:53:20.347028 14219 net.cpp:397] ReLU6 -> fc6 (in-place)
I0429 16:53:20.347465 14219 net.cpp:150] Setting up ReLU6
I0429 16:53:20.347503 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.347520 14219 net.cpp:165] Memory required for data: 2009170176
I0429 16:53:20.347537 14219 layer_factory.hpp:77] Creating layer drop6
I0429 16:53:20.347558 14219 net.cpp:106] Creating Layer drop6
I0429 16:53:20.347575 14219 net.cpp:454] drop6 <- fc6
I0429 16:53:20.347595 14219 net.cpp:397] drop6 -> fc6 (in-place)
I0429 16:53:20.347648 14219 net.cpp:150] Setting up drop6
I0429 16:53:20.347673 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.347688 14219 net.cpp:165] Memory required for data: 2009432320
I0429 16:53:20.347704 14219 layer_factory.hpp:77] Creating layer fc7
I0429 16:53:20.347725 14219 net.cpp:106] Creating Layer fc7
I0429 16:53:20.347744 14219 net.cpp:454] fc7 <- fc6
I0429 16:53:20.347762 14219 net.cpp:411] fc7 -> fc7
I0429 16:53:20.385522 14219 net.cpp:150] Setting up fc7
I0429 16:53:20.385624 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.385642 14219 net.cpp:165] Memory required for data: 2009694464
I0429 16:53:20.385663 14219 layer_factory.hpp:77] Creating layer ReLU7
I0429 16:53:20.385687 14219 net.cpp:106] Creating Layer ReLU7
I0429 16:53:20.385705 14219 net.cpp:454] ReLU7 <- fc7
I0429 16:53:20.385725 14219 net.cpp:397] ReLU7 -> fc7 (in-place)
I0429 16:53:20.386165 14219 net.cpp:150] Setting up ReLU7
I0429 16:53:20.386201 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.386219 14219 net.cpp:165] Memory required for data: 2009956608
I0429 16:53:20.386234 14219 layer_factory.hpp:77] Creating layer drop7
I0429 16:53:20.386252 14219 net.cpp:106] Creating Layer drop7
I0429 16:53:20.386268 14219 net.cpp:454] drop7 <- fc7
I0429 16:53:20.386286 14219 net.cpp:397] drop7 -> fc7 (in-place)
I0429 16:53:20.386337 14219 net.cpp:150] Setting up drop7
I0429 16:53:20.386359 14219 net.cpp:157] Top shape: 16 4096 (65536)
I0429 16:53:20.386373 14219 net.cpp:165] Memory required for data: 2010218752
I0429 16:53:20.386387 14219 layer_factory.hpp:77] Creating layer fc8_foodCAT
I0429 16:53:20.386451 14219 net.cpp:106] Creating Layer fc8_foodCAT
I0429 16:53:20.386468 14219 net.cpp:454] fc8_foodCAT <- fc7
I0429 16:53:20.386487 14219 net.cpp:411] fc8_foodCAT -> fc8_foodCAT
I0429 16:53:20.388730 14219 net.cpp:150] Setting up fc8_foodCAT
I0429 16:53:20.388763 14219 net.cpp:157] Top shape: 16 218 (3488)
I0429 16:53:20.388780 14219 net.cpp:165] Memory required for data: 2010232704
I0429 16:53:20.388798 14219 layer_factory.hpp:77] Creating layer fc8_foodCAT_fc8_foodCAT_0_split
I0429 16:53:20.388828 14219 net.cpp:106] Creating Layer fc8_foodCAT_fc8_foodCAT_0_split
I0429 16:53:20.388849 14219 net.cpp:454] fc8_foodCAT_fc8_foodCAT_0_split <- fc8_foodCAT
I0429 16:53:20.388869 14219 net.cpp:411] fc8_foodCAT_fc8_foodCAT_0_split -> fc8_foodCAT_fc8_foodCAT_0_split_0
I0429 16:53:20.388890 14219 net.cpp:411] fc8_foodCAT_fc8_foodCAT_0_split -> fc8_foodCAT_fc8_foodCAT_0_split_1
I0429 16:53:20.388909 14219 net.cpp:411] fc8_foodCAT_fc8_foodCAT_0_split -> fc8_foodCAT_fc8_foodCAT_0_split_2
I0429 16:53:20.388981 14219 net.cpp:150] Setting up fc8_foodCAT_fc8_foodCAT_0_split
I0429 16:53:20.389004 14219 net.cpp:157] Top shape: 16 218 (3488)
I0429 16:53:20.389020 14219 net.cpp:157] Top shape: 16 218 (3488)
I0429 16:53:20.389034 14219 net.cpp:157] Top shape: 16 218 (3488)
I0429 16:53:20.389048 14219 net.cpp:165] Memory required for data: 2010274560
I0429 16:53:20.389062 14219 layer_factory.hpp:77] Creating layer loss
I0429 16:53:20.389080 14219 net.cpp:106] Creating Layer loss
I0429 16:53:20.389096 14219 net.cpp:454] loss <- fc8_foodCAT_fc8_foodCAT_0_split_0
I0429 16:53:20.389111 14219 net.cpp:454] loss <- label_data_1_split_0
I0429 16:53:20.389129 14219 net.cpp:411] loss -> loss/loss
I0429 16:53:20.389156 14219 layer_factory.hpp:77] Creating layer loss
I0429 16:53:20.389428 14219 net.cpp:150] Setting up loss
I0429 16:53:20.389461 14219 net.cpp:157] Top shape: (1)
I0429 16:53:20.389477 14219 net.cpp:160]     with loss weight 1
I0429 16:53:20.389499 14219 net.cpp:165] Memory required for data: 2010274564
I0429 16:53:20.389514 14219 layer_factory.hpp:77] Creating layer accuracy/top1
I0429 16:53:20.389538 14219 net.cpp:106] Creating Layer accuracy/top1
I0429 16:53:20.389556 14219 net.cpp:454] accuracy/top1 <- fc8_foodCAT_fc8_foodCAT_0_split_1
I0429 16:53:20.389572 14219 net.cpp:454] accuracy/top1 <- label_data_1_split_1
I0429 16:53:20.389590 14219 net.cpp:411] accuracy/top1 -> accuracy@1
I0429 16:53:20.389612 14219 net.cpp:150] Setting up accuracy/top1
I0429 16:53:20.389631 14219 net.cpp:157] Top shape: (1)
I0429 16:53:20.389645 14219 net.cpp:165] Memory required for data: 2010274568
I0429 16:53:20.389659 14219 layer_factory.hpp:77] Creating layer accuracy/top5
I0429 16:53:20.389677 14219 net.cpp:106] Creating Layer accuracy/top5
I0429 16:53:20.389693 14219 net.cpp:454] accuracy/top5 <- fc8_foodCAT_fc8_foodCAT_0_split_2
I0429 16:53:20.389708 14219 net.cpp:454] accuracy/top5 <- label_data_1_split_2
I0429 16:53:20.389724 14219 net.cpp:411] accuracy/top5 -> accuracy@5
I0429 16:53:20.389746 14219 net.cpp:150] Setting up accuracy/top5
I0429 16:53:20.389763 14219 net.cpp:157] Top shape: (1)
I0429 16:53:20.389777 14219 net.cpp:165] Memory required for data: 2010274572
I0429 16:53:20.389791 14219 net.cpp:228] accuracy/top5 does not need backward computation.
I0429 16:53:20.389806 14219 net.cpp:228] accuracy/top1 does not need backward computation.
I0429 16:53:20.389821 14219 net.cpp:226] loss needs backward computation.
I0429 16:53:20.389834 14219 net.cpp:226] fc8_foodCAT_fc8_foodCAT_0_split needs backward computation.
I0429 16:53:20.389853 14219 net.cpp:226] fc8_foodCAT needs backward computation.
I0429 16:53:20.389868 14219 net.cpp:226] drop7 needs backward computation.
I0429 16:53:20.389881 14219 net.cpp:226] ReLU7 needs backward computation.
I0429 16:53:20.389894 14219 net.cpp:226] fc7 needs backward computation.
I0429 16:53:20.389909 14219 net.cpp:226] drop6 needs backward computation.
I0429 16:53:20.389922 14219 net.cpp:226] ReLU6 needs backward computation.
I0429 16:53:20.389935 14219 net.cpp:226] fc6 needs backward computation.
I0429 16:53:20.389997 14219 net.cpp:226] pool5 needs backward computation.
I0429 16:53:20.390027 14219 net.cpp:226] ReLU5_4 needs backward computation.
I0429 16:53:20.390053 14219 net.cpp:226] conv5_4 needs backward computation.
I0429 16:53:20.390077 14219 net.cpp:226] ReLU5_3 needs backward computation.
I0429 16:53:20.390102 14219 net.cpp:226] conv5_3 needs backward computation.
I0429 16:53:20.390128 14219 net.cpp:226] ReLU5_2 needs backward computation.
I0429 16:53:20.390156 14219 net.cpp:226] conv5_2 needs backward computation.
I0429 16:53:20.390182 14219 net.cpp:226] ReLU5_1 needs backward computation.
I0429 16:53:20.390195 14219 net.cpp:226] conv5_1 needs backward computation.
I0429 16:53:20.390221 14219 net.cpp:226] pool4 needs backward computation.
I0429 16:53:20.390236 14219 net.cpp:226] ReLU4_4 needs backward computation.
I0429 16:53:20.390261 14219 net.cpp:226] conv4_4 needs backward computation.
I0429 16:53:20.390288 14219 net.cpp:226] ReLU4_3 needs backward computation.
I0429 16:53:20.390314 14219 net.cpp:226] conv4_3 needs backward computation.
I0429 16:53:20.390331 14219 net.cpp:226] ReLU4_2 needs backward computation.
I0429 16:53:20.390346 14219 net.cpp:226] conv4_2 needs backward computation.
I0429 16:53:20.390360 14219 net.cpp:226] ReLU4_1 needs backward computation.
I0429 16:53:20.390377 14219 net.cpp:226] conv4_1 needs backward computation.
I0429 16:53:20.390391 14219 net.cpp:226] pool3 needs backward computation.
I0429 16:53:20.390406 14219 net.cpp:226] ReLU3_4 needs backward computation.
I0429 16:53:20.390421 14219 net.cpp:226] conv3_4 needs backward computation.
I0429 16:53:20.390435 14219 net.cpp:226] ReLU3_3 needs backward computation.
I0429 16:53:20.390461 14219 net.cpp:226] conv3_3 needs backward computation.
I0429 16:53:20.390489 14219 net.cpp:226] ReLU3_2 needs backward computation.
I0429 16:53:20.390514 14219 net.cpp:226] conv3_2 needs backward computation.
I0429 16:53:20.390539 14219 net.cpp:226] ReLU3_1 needs backward computation.
I0429 16:53:20.390563 14219 net.cpp:226] conv3_1 needs backward computation.
I0429 16:53:20.390578 14219 net.cpp:226] pool2 needs backward computation.
I0429 16:53:20.390591 14219 net.cpp:226] ReLU2_2 needs backward computation.
I0429 16:53:20.390605 14219 net.cpp:226] conv2_2 needs backward computation.
I0429 16:53:20.390619 14219 net.cpp:226] ReLU2_1 needs backward computation.
I0429 16:53:20.390633 14219 net.cpp:226] conv2_1 needs backward computation.
I0429 16:53:20.390647 14219 net.cpp:226] pool1 needs backward computation.
I0429 16:53:20.390684 14219 net.cpp:226] ReLU1_2 needs backward computation.
I0429 16:53:20.390710 14219 net.cpp:226] conv1_2 needs backward computation.
I0429 16:53:20.390736 14219 net.cpp:226] ReLU1_1 needs backward computation.
I0429 16:53:20.390780 14219 net.cpp:226] conv1_1 needs backward computation.
I0429 16:53:20.390797 14219 net.cpp:228] label_data_1_split does not need backward computation.
I0429 16:53:20.390815 14219 net.cpp:228] data does not need backward computation.
I0429 16:53:20.390830 14219 net.cpp:270] This network produces output accuracy@1
I0429 16:53:20.390849 14219 net.cpp:270] This network produces output accuracy@5
I0429 16:53:20.390877 14219 net.cpp:270] This network produces output loss/loss
I0429 16:53:20.390954 14219 net.cpp:283] Network initialization done.
I0429 16:53:20.391155 14219 solver.cpp:60] Solver scaffolding done.
I0429 16:53:20.392662 14219 caffe.cpp:129] Finetuning from models/foodCAT_VGG_ILSVRC_19_layers/snapshots/VGG_ILSVRC_19_layers.caffemodel
[libprotobuf WARNING google/protobuf/io/coded_stream.cc:537] Reading dangerously large protocol message.  If the message turns out to be larger than 2147483647 bytes, parsing will be halted for security reasons.  To increase the limit (or to disable these warnings), see CodedInputStream::SetTotalBytesLimit() in google/protobuf/io/coded_stream.h.
[libprotobuf WARNING google/protobuf/io/coded_stream.cc:78] The total number of bytes read was 574671192
I0429 16:53:22.851990 14219 upgrade_proto.cpp:51] Attempting to upgrade input file specified using deprecated V1LayerParameter: models/foodCAT_VGG_ILSVRC_19_layers/snapshots/VGG_ILSVRC_19_layers.caffemodel
/var/spool/slurmd/job5796150/slurm_script: line 8: 14219 Killed                  caffe train -solver models/foodCAT_VGG_ILSVRC_19_layers/CLUSTER/solver.prototxt -weights models/foodCAT_VGG_ILSVRC_19_layers/snapshots/VGG_ILSVRC_19_layers.caffemodel
slurmstepd: Exceeded step memory limit at some point.
